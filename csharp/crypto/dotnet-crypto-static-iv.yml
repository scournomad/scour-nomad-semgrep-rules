rules:
  - id: dotnet-crypto-static-iv
    languages: [csharp]
    message: Static IV detected. Use random IV per encryption operation.
    severity: WARNING
    patterns:
      - pattern-either:
          - pattern: $AES.IV = new byte[] { ... }
          - pattern: $AES.IV = Convert.FromBase64String("...")
    metadata:
      cwe: "CWE-329: Generation of Predictable IV with CBC Mode"
      owasp: "A02:2021-Cryptographic Failures"
      confidence: low
      references:
        - https://learn.microsoft.com/dotnet/standard/security/cryptographic-services
      verification:
        strategy: unit
        steps:
          - Inspect code for constant IV assignment
        expected_outcome: Static IV assignment present
        tooling:
          unit: xunit
          dast: none
