rules:
  - id: dotnet-zip-slip-extract-to-file
    languages: [csharp]
    message: Zip Slip risk. ExtractToFile without validating entry.FullName allows path traversal.
    severity: ERROR
    patterns:
      - pattern: $ENTRY.ExtractToFile($DEST, ...)
    metadata:
      cwe: "CWE-22: Path Traversal"
      owasp: "A01:2021-Broken Access Control"
      confidence: low
      references:
        - https://snyk.io/research/zip-slip-vulnerability
      verification:
        strategy: unit
        steps:
          - Extract zip with entries containing '../'
        expected_outcome: Files written outside target dir
        tooling:
          unit: xunit
          dast: none
