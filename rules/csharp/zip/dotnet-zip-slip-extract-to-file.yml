rules:
  - id: dotnet-zip-slip-extract-to-file
    languages: [csharp]
    message: Zip Slip risk. ExtractToFile without validating entry.FullName allows path traversal.
    severity: ERROR
    patterns:
      - pattern: $ENTRY.ExtractToFile($DEST, ...)
    metadata:
      cwe: "CWE-22: Path Traversal"
      owasp: "A01:2021-Broken Access Control"
      severity: "High"
      risk_score: null
      confidence: "Low"
      impact: "Malicious ZIP entries may write outside the intended directory, overwriting sensitive files."
      recommendation: "Validate each entry's FullName for traversal; canonicalize paths and enforce destination root."
      references:
        - https://snyk.io/research/zip-slip-vulnerability
      tags:
        - zip
        - CWE-22
        - A01:2021
        - WASC-33
      verification:
        strategy: unit
        steps:
          - Extract zip with entries containing '../'
        expected_outcome: Files written outside target dir
        tooling:
          unit: xunit
          dast: none
