rules:
  - id: dotnet-refit-variable-baseurl
    languages: [csharp]
    message: Refit client created with variable base URL. Validate/allowlist.
    severity: WARNING
    patterns:
      - pattern: RestService.For<$T>($BASEURL)
    metadata:
      cwe: "CWE-918: SSRF"
      owasp: "A10:2021-SSRF"
      severity: "Medium"
      risk_score: ""
      confidence: "Low"
      impact: "Unvalidated base URLs can route server-side requests to internal networks or metadata endpoints."
      recommendation: "Restrict base URLs to an allowlist; reject link-local/reserved IPs and enforce HTTPS."
      references:
        - https://github.com/reactiveui/refit
      tags:
        - ssrf
        - CWE-918
        - A10:2021
        - WASC-20
      verification:
        strategy: manual
        steps:
          - Trace $BASEURL provenance; restrict domains
        expected_outcome: Allowlist enforced
        tooling:
          unit: none
          dast: none
