rules:
  - id: dotnet-deserialization-datacontract-preserve-references
    languages: [csharp]
    message: DataContractSerializer with PreserveObjectReferences=true can leak type graph details; ensure trusted input.
    severity: WARNING
    patterns:
      - pattern-either:
          - pattern: new DataContractSerializer($T, new DataContractSerializerSettings { PreserveObjectReferences = true, ... })
    metadata:
      cwe: "CWE-502: Deserialization of Untrusted Data"
      owasp: "A08:2021-Software and Data Integrity Failures"
      confidence: low
      references:
        - https://learn.microsoft.com/dotnet/framework/wcf/feature-details/serialization-and-deserialization
      verification:
        strategy: manual
        steps:
          - Confirm input is trusted or types constrained
        expected_outcome: Safe usage or flagged for review
        tooling:
          unit: none
          dast: none
