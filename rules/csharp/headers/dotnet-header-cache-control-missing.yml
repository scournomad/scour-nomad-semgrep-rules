rules:
  - id: dotnet-header-cache-control-missing
    languages: [csharp]
    message: Missing Cache-Control/Pragma no-store on sensitive responses can leak data.
    severity: WARNING
    patterns:
      - pattern: return $R
    pattern-not: |
      Response.Headers["Cache-Control"] = "no-store"
    metadata:
      cwe: "CWE-524: Use of Cache Containing Sensitive Information"
      owasp: "A06:2021-Vulnerable and Outdated Components"
      severity: "Medium"
      risk_score: ""
      confidence: "Low"
      impact: "Sensitive responses without no-store/no-cache directives may be cached by browsers or proxies, exposing private data."
      recommendation: "Set Cache-Control: no-store, no-cache and Pragma: no-cache for sensitive responses, and consider setting appropriate Expires headers."
      references:
        - https://cheatsheetseries.owasp.org/cheatsheets/REST_Security_Cheat_Sheet.html
      tags:
        - headers
        - CWE-524
        - A06:2021
        - WASC-13
      verification:
        strategy: manual
        steps:
          - Confirm endpoint returns sensitive data without no-store
        expected_outcome: Sensitive data may be cached
        tooling:
          unit: none
          dast: none
